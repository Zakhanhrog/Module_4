<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{fragments/header :: header(pageTitle=${pageTitle})}"></head>
<body>
<div th:replace="~{fragments/navbar :: navbar}"></div>

<main class="container mt-4 flex-grow-1">
    <h1 th:text="${pageTitle}">Danh sách Khóa học</h1>

    <div th:if="${successMessage}" class="alert alert-success" role="alert" th:text="${successMessage}"></div>
    <div th:if="${errorMessage}" class="alert alert-danger" role="alert" th:text="${errorMessage}"></div>

    <div th:if="${#lists.isEmpty(courses)}" class="alert alert-info mt-3" role="alert">
        Hiện tại chưa có khóa học nào được mở. Vui lòng quay lại sau!
    </div>

    <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4" th:if="${not #lists.isEmpty(courses)}">
        <div th:each="course : ${courses}" class="col">
            <div class="card h-100 shadow-sm">
                <th:block th:with="imageUrlToDisplay=${(course.imageUrl != null && !course.imageUrl.isEmpty()) ? course.imageUrl : '/images/course_placeholder.png'}">
                    <img th:src="@{${imageUrlToDisplay}}" class="card-img-top" th:alt="${course.name}">
                </th:block>
                <div class="card-body d-flex flex-column">
                    <h5 class="card-title" th:text="${course.name}">Tên Khóa học</h5>
                    <p class="card-text small text-muted flex-grow-1" th:text="${#strings.abbreviate(course.description, 120)}">Mô tả ngắn.</p>
                    <p class="card-text mb-1"><strong>Học phí:</strong> <span th:text="${course.tuitionFee != null ? #numbers.formatDecimal(course.tuitionFee, 0, 'COMMA', 0, 'POINT') + ' VNĐ' : 'Liên hệ'}"></span></p>
                    <p class="card-text small mb-2"><strong>Đối tượng:</strong> <span th:text="${course.targetAudience ?: 'Mọi lứa tuổi'}"></span></p>
                    <p class="card-text small"><strong>Thời lượng:</strong> <span th:text="${course.duration ?: 'N/A'}"></span></p>
                    <a th:href="@{/courses/{id}(id=${course.id})}" class="btn btn-primary mt-auto align-self-start">Xem chi tiết</a>
                </div>
            </div>
        </div>
    </div>
</main>

<div th:replace="~{fragments/footer :: footer}"></div>
</body>
</html>